---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import TutorialCard from '../components/TutorialCard.astro';

const tutorials = await getCollection('tutorials');
const sortedTutorials = tutorials.sort((a, b) => 
	new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

// Extract all unique tags
const allTags = [...new Set(tutorials.flatMap(t => t.data.tags))].sort();
---

<BaseLayout title="HowTo | Radhey's Tech Tutorials">
	<Header showSearch={true} allTags={allTags} />
	<main class="pt-24 pb-16 px-6">
		<div class="max-w-4xl mx-auto">
			{sortedTutorials.length === 0 ? (
				<p class="text-[var(--muted)] text-center py-12">
					No tutorials yet. Check back soon!
				</p>
			) : (
				<div class="grid gap-4">
					{sortedTutorials.map((tutorial) => (
						<TutorialCard
							title={tutorial.data.title}
							description={tutorial.data.description}
							date={tutorial.data.date}
							slug={tutorial.id.replace(/\.md$/, '')}
							tags={tutorial.data.tags}
							youtubeUrl={tutorial.data.youtubeUrl}
						/>
					))}
				</div>
			)}

			<!-- Empty state for filtered results -->
			<div class="empty-state hidden text-[var(--muted)] text-center py-12">
				No tutorials match the selected filters.
			</div>
		</div>
	</main>
</BaseLayout>
